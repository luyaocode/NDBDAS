#!/usr/bin/python
# coding=utf8
"""
# Author: first_team
# Created Time : 2019-11-26 11:10:30
# Mail: 4418229@qq.com
# File Name: dlt645di.py
# Description:

"""

# funcode
ReadCoil = "01"  # 读线圈状态
ReadDispersion = "02"  # 读离散输入状态
ReadHoldReg = "03"  # 读保持寄存器
ReadInputReg = "04"  # 读输入寄存器
WriteSignalCoil = "05"  # 写线圈状态
WriteSignalHoldReg = "06"  # 写单个保持寄存器
WriteMultipleCoil = "0F"  # 写多个线圈
WriteMultipleHoldReg = "10"  # 写多个保持寄存器

# mb_TCP_regaddr是字典
TCP_to_645Status = {
    # (线圈地址): ()(对应645协议的电器开关状态, 小数位数读写控制码)(单位）(中文名称)
    "00001": ("08000000", "电操状态"),
    "00002": ("08000100", "一次状态"),
    "00003": ("08000200", "二次状态"),
    "00004": ("08000300", "KM1状态"),
    "00005": ("08000400", "KM2状态"),
    "00006": ("08000500", "KM3状态"),
}
TCP_to_645DI = {
    # 电压
    "30001": ("02010100", "A相电压"),  # 2字节
    "30002": ("02010200", "B相电压"),  # 2字节
    "30003": ("02010300", "C相电压"),  # 2字节
    "30004": ("0201FF00", "电压数据块"),  # 总6字节
    # 电流
    "30005": ("02020100", "A相电流"),  # 2字节
    "30006": ("02020200", "B相电流"),  # 2字节
    "30007": ("02020300", "C相电流"),  # 2字节
    "30008": ("0202FF00", "电流数据块"),  # 总6字节
    # 有功功率
    "30009": ("02030000", "瞬时总有功功率"),  # 2字节
    "30010": ("02030100", "瞬时A相有功功率"),  # 2字节
    "30011": ("02030200", "瞬时B相有功功率"),  # 2字节
    "30012": ("02030300", "瞬时C相有功功率"),  # 2字节
    "30013": ("0203FF00", "瞬时有功功率数据块"),  # 8字节
    # 无功功率
    "30014": ("02040000", "瞬时总无功功率"),  # 2字节
    "30015": ("02040100", "瞬时A相无功功率"),  # 2字节
    "30016": ("02040200", "瞬时B相无功功率"),  # 2字节
    "30017": ("02040300", "瞬时C相无功功率"),  # 2字节
    "30018": ("0204FF00", "瞬时无功功率数据块"),  # 8字节
    # 视在功率
    "30019": ("02050000", "瞬时总视在功率"),  # 2字节
    "30020": ("02050100", "瞬时A相视在功率"),  # 2字节
    "30021": ("02050200", "瞬时B相视在功率"),  # 2字节
    "30022": ("02050300", "瞬时C相视在功率"),  # 2字节
    "30023": ("0205FF00", "瞬时视在功率数据块"),  # 8字节

    # 功率因数
    "30024": ("02060000", "总功率因数"),  # 2字节
    "30025": ("02060100", "A相功率因数"),  # 2字节
    "30026": ("02060200", "B相功率因数"),  # 2字节
    "30027": ("02060300", "C相功率因数"),  # 2字节
    "30028": ("0206FF00", "功率因数数据块"),  # 8字节


    # (保持寄存器地址): ()(对应645协议的数据标志, 小数位数读写控制码)(单位）(中文名称)
    "40001": ("00000000", "组合有功总电能"),
    "40002": ("00000100", "组合有功费率1电能"),
    "40003": ("000002000", "组合有功费率2电能"),
    "40004": ("00000300", "组合有功费率3电能"),
    "40005": ("00000400", "组合有功费率4电能"),
    "40006": ("0000FF00", "组合有功电能数据块"),
    ######################################################################
    "40007": ("00010000", "组合有功总电能"),
    "40008": ("00010100", "组合有功费率1电能"),
    "40009": ("00010200", "组合有功费率2电能"),
    "40010": ("00010300", "组合有功费率3电能"),
    "40011": ("00010400", "组合有功费率4电能"),
    "40012": ("0001FF00", "组合有功电能数据块")
}
TCP_to_645ADDR = {
    "01": "000001220901",
    "02": "000002220901",
    "03": "000003220901",
    "04": "000004220901",
    "05": "000005220901",
    "06": "000006220901",
    "07": "000007220901",
    "08": "000008220901",
    "09": "000009220901",
    "10": "000010220901",
    "11": "000011220901",
    "12": "000012220901",
    "13": "000013220901",
    "14": "000014220901",
    "15": "000015220901",
    "16": "000016220901",
    "17": "000017220901",
    "18": "000018220901",
    "19": "000019220901",
    "20": "000020220901",
    "21": "000021220901",
    "22": "000022220901",
    "23": "000023220901",
    "24": "000024220901",
    "25": "000025220901",
    "26": "000026220901",
    "27": "000027220901",
    "28": "000028220901",
    "29": "000029220901",
    "30": "000030220901",
}
